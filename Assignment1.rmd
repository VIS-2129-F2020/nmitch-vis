---
title: "Assignment 1"
author: "Nickie Mitch"
date: "9/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading libraries

```{r load libraries, message=FALSE}
library(tidycensus)
library(tidyverse)
library(ggplot2)
```

## Reviewing variables

```{r view variables, message=FALSE}
area_vars_2010 <- load_variables(2010, "sf1")
```

## Selecting and loading variables

``` {r load variables, message=FALSE}
vars <- c(tot_housing_units = "H001001",
          tot_vacant = "H003003",
          tot_one_person_hh = "P019002",
          tot_rented = "H004004",
          tot_urban = "H002002",
          tot_pop = "P003001", 
          tot_female = "P012026",
          tot_male = "P012002")
Barth_tracts <- get_decennial(geography = "tract", variables = vars,
                           state = "IN", county = "Bartholomew",
                           output = "wide") %>%
  mutate(urban = (tot_urban == tot_housing_units) ,
         pct_vacant = tot_vacant / tot_housing_units,
         pct_rented = tot_rented / tot_housing_units,
         majority_gender = case_when(
           tot_female / tot_pop > 0.5 ~ "female",
           tot_male / tot_pop > 0.5 ~ "male",
           TRUE ~ "None")) %>%
  filter(tot_pop > 0, tot_housing_units > 0) %>%
  select(GEOID, urban, majority_gender, pct_rented, pct_vacant, tot_one_person_hh, tot_pop) 

```

## Displaying selected variables

```{r show loaded microdata variables, message=FALSE}
Barth_tracts
```

## Figure 1 - Scatterplot with all variables

```{r generate figure 1}
ggplot(Barth_tracts, 
       aes(x = pct_rented,
           y = pct_vacant,
           size = tot_one_person_hh,
           shape = urban,
           color = majority_gender,
           alpha = tot_pop)) +
  geom_point() +
  scale_size_continuous(name = "Total one-person households in tract") +
  scale_x_continuous(name = "Percent of households in rented homes",
                     breaks = seq(0, 1, by = 0.1),
                     labels = paste(seq(0, 100, by = 10), "%", sep = "")) +
  scale_y_continuous(name = "Percent of housing units vacant",
                     breaks = seq(10, 80, by = 10)) +
  scale_color_discrete(name = "Majority gender",
                       labels = c("Male",
                       "Female")) +
  scale_alpha_continuous(name = "Total population of tract") +
  scale_shape(name = element_blank(), 
              labels = c("Urban tract", "Rural tract")) +
  theme_bw() +
  theme(legend.key.size = unit(0.1, "cm"))
```

## Figure 2 - Bar chart with all categorical variables

```{r generate figure 2}
ggplot(Barth_tracts, aes(x = majority_gender, fill = urban)) +
  geom_bar() +
  scale_y_continuous(name = "Number of tracts") +
  scale_x_discrete(name = "Majority gender",
                       labels = c("Male", 
                                  "Female")) +
  scale_fill_discrete(name = element_blank(),
                        labels = c("Urban tracts",
                                   "Rural tracts")) +
  theme_bw() 
```

## Figure 3 - Scatterplot with two continuous variables and one categorical variable

```{r generate figure 3}
ggplot(Barth_tracts, 
       aes(x = pct_vacant,
           y = tot_pop,
           color = urban)) +
  geom_point() +
  scale_x_continuous(name = "Percent of housing units vacant",
                     breaks = seq(0, 1, by = 0.01),
                     labels = paste(seq(0, 100, by = 1), "%", sep = "")) +
  scale_y_continuous(name = "Total population of tract",
                     breaks = seq(1000, 10000, by = 1000)) +
  scale_color_discrete(name = "Setting",
                       labels = c("urban", "rural")) +
  theme_bw()
```

## Figure 4 - Scatterplot with two continuous variables and one categorical variable with a trendline


```{r generate figure 4}
ggplot(Barth_tracts, 
       aes(x = pct_vacant,
           y = tot_pop,
           color = urban)) +
  geom_point() +
  stat_smooth(method = "lm") +
  scale_x_continuous(name = "Percent of housing units vacant",
                     breaks = seq(0, 1, by = 0.01),
                     labels = paste(seq(0, 100, by = 1), "%", sep = "")) +
  scale_y_continuous(name = "Total population of tract",
                     breaks = seq(1000, 10000, by = 1000)) +
  scale_color_discrete(name = "Setting",
                       labels = c("urban", "rural")) +
  theme_bw()
```

## Figure 5 - Scatterplot in Polar Coordinate System with Two Continuous Variables and one categorical variable

```{r generate figure 5}
ggplot(Barth_tracts, 
       aes(x = pct_vacant,
           y = tot_pop,
           color = majority_gender)) +
  geom_point() +
  scale_x_continuous(name = "Percent of housing units vacant",
                     breaks = seq(0, 1, by = 0.01),
                     labels = paste(seq(0, 100, by = 1), "%", sep = "")) +
  scale_y_continuous(name = "Total population of tract",
                     breaks = seq(1000, 10000, by = 1000)) +
  scale_color_discrete(name = "Majority Gender",
                       labels = c("male", "female")) +
  coord_polar(theta = "x") +
  theme_bw()
```

## Figure 6 - Scatterplot with two continuous variables

```{r generate figure 6}
ggplot(Barth_tracts, 
       aes(x = pct_rented,
           y = tot_pop,)) +
  geom_point(size = 4) +
  scale_x_continuous(name = "Percent of housing units vacant",
                     breaks = seq(0, 1, by = 0.01),
                     labels = paste(seq(0, 100, by = 1), "%", sep = "")) +
  scale_y_continuous(name = "Total population of tract",
                     breaks = seq(1000, 10000, by = 1000)) +
  theme_bw() +
  theme(legend.key.size = unit(0.1, "cm"))
```
